<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>üß† NeuroQuantumAI</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="NeuroQuantumAI">
    
    <!-- Inline Manifest -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiTmV1cm9RdWFudHVtQUkiLCJzaG9ydF9uYW1lIjoiTmV1cm9BSSIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjMWExYTJlIiwidGhlbWVfY29sb3IiOiIjMWExYTJlIiwiaWNvbnMiOlt7InNyYyI6ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBSEFBQUFCd0NBWUFBQUJYQXZtSEFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFDQmpTRkpOQUFCNkpnQUFnSVFBQVBvQUFBQ0E2QUFBZFRBQUFPUE1BQUI2SkFBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9QTUFBQjZKZ0FBZ0lRQUFQb0FBQUNBNkFBQWRUQUFBT1BNQUFCNkpnQUFnSVFBQVBvQUFBQ0E2QUFBZFRBQUFPUE1BQUFBQUVsRlRrU3VRbUNDIiwic2l6ZXMiOiIxOTJ4MTkyIiwidHlwZSI6ImltYWdlL3BuZyJ9XX0=">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            height: 100%;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e);
            color: white;
            -webkit-font-smoothing: antialiased;
        }
        
        .app-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .app-header {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            padding: 12px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
            z-index: 100;
        }
        
        .app-title {
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .app-subtitle {
            font-size: 12px;
            text-align: center;
            opacity: 0.7;
            margin-top: 2px;
        }
        
        .chat-area {
            flex: 1;
            overflow-y: auto;
            padding: 0;
            position: relative;
            -webkit-overflow-scrolling: touch;
        }
        
        .messages-container {
            padding: 20px;
            padding-bottom: 20px;
            min-height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .message {
            margin-bottom: 16px;
            max-width: 85%;
            word-wrap: break-word;
            animation: messageSlide 0.3s ease-out;
        }
        
        .message-content {
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 15px;
            line-height: 1.4;
        }
        
        .user-message {
            align-self: flex-end;
        }
        
        .user-message .message-content {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-bottom-right-radius: 6px;
        }
        
        .ai-message {
            align-self: flex-start;
        }
        
        .ai-message .message-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom-left-radius: 6px;
        }
        
        .input-area {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 16px 20px;
            padding-bottom: 20px;
            flex-shrink: 0;
            z-index: 100;
        }
        
        .input-wrapper {
            display: flex;
            gap: 12px;
            align-items: flex-end;
            max-width: 100%;
        }
        
        .input-field {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 12px 16px;
            color: white;
            font-size: 16px;
            outline: none;
            resize: none;
            min-height: 44px;
            max-height: 120px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }
        
        .input-field::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .send-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 20px;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .send-button:active {
            transform: scale(0.95);
        }
        
        .send-icon {
            width: 20px;
            height: 20px;
            fill: white;
        }
        
        .install-prompt {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            transform: translateY(-200px);
            transition: transform 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            display: none;
        }
        
        .install-prompt.show {
            display: block;
            transform: translateY(0);
        }
        
        .install-button {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            margin: 5px;
        }
        
        .install-button.primary {
            background: rgba(255, 255, 255, 0.9);
            color: #667eea;
            font-weight: 600;
        }
        
        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .system-status {
            position: fixed;
            top: 60px;
            right: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4CAF50;
            z-index: 200;
            animation: statusPulse 2s infinite;
        }
        
        @keyframes statusPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="app-header">
            <div class="app-title">üß† NeuroQuantumAI</div>
            <div class="app-subtitle">Twoja osobista sztuczna inteligencja</div>
        </div>
        
        <div class="system-status" id="systemStatus" title="Status system√≥w AI"></div>
        
        <div class="chat-area" id="chatArea">
            <div class="messages-container" id="messagesContainer">
                <div class="message ai-message">
                    <div class="message-content">
                        üöÄ <strong>Inicjalizacja NeuroQuantumAI...</strong><br><br>
                        ≈Åadowanie system√≥w AI:<br>
                        ‚Ä¢ Advanced AI System<br>
                        ‚Ä¢ Task Classification<br>
                        ‚Ä¢ Intelligent Task Engine<br>
                        ‚Ä¢ Advanced Reasoning<br>
                        ‚Ä¢ Wake Lock Manager<br>
                        <br><em>Proszƒô czekaƒá...</em>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="input-area">
            <div class="input-wrapper">
                <textarea 
                    class="input-field" 
                    id="messageInput" 
                    placeholder="Inicjalizacja..." 
                    rows="1"
                    disabled
                ></textarea>
                <button class="send-button" id="sendButton" disabled>
                    <svg class="send-icon" viewBox="0 0 24 24">
                        <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <div class="install-prompt" id="installPrompt">
            <div><strong>üì± Zainstaluj NeuroQuantumAI</strong></div>
            <div>Dodaj aplikacjƒô do ekranu g≈Ç√≥wnego!</div>
            <div>
                <button class="install-button primary" id="installButton">Zainstaluj</button>
                <button class="install-button" id="dismissButton">P√≥≈∫niej</button>
            </div>
        </div>
    </div>

    <script>
        console.log('üß† NeuroQuantumAI Android Installer Loading...');
        
        // Podstawowe zmienne
        let app = null;
        let isInitialized = false;
        let messageCounter = 0;
        
        // Elementy DOM
        const chatArea = document.getElementById('chatArea');
        const messagesContainer = document.getElementById('messagesContainer');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const systemStatus = document.getElementById('systemStatus');
        const installPrompt = document.getElementById('installPrompt');
        
        console.log('‚úÖ Podstawowe elementy za≈Çadowane');
        
        // =============================================================================
        // SYSTEMY AI - ETAP 2A: WAKE LOCK MANAGER
        // =============================================================================
        
        class WakeLockManager {
            constructor() {
                this.wakeLock = null;
                this.isSupported = 'wakeLock' in navigator;
                this.isActive = false;
                this.stats = { activationCount: 0, totalTime: 0 };
            }
            
            async initialize() {
                console.log('üîí Wake Lock Manager inicjalizacja...');
                return true;
            }
            
            async request(reason = 'user') {
                if (!this.isSupported) {
                    console.log('‚ö†Ô∏è Wake Lock nie obs≈Çugiwany - u≈ºywam fallback');
                    return this.requestFallback();
                }
                
                try {
                    this.wakeLock = await navigator.wakeLock.request('screen');
                    this.isActive = true;
                    this.stats.activationCount++;
                    console.log('üîí Wake Lock aktywowany');
                    return true;
                } catch (error) {
                    console.warn('‚ö†Ô∏è Wake Lock b≈ÇƒÖd:', error);
                    return this.requestFallback();
                }
            }
            
            async release(reason = 'user') {
                if (this.wakeLock) {
                    await this.wakeLock.release();
                    this.wakeLock = null;
                }
                this.isActive = false;
                console.log('üîì Wake Lock zwolniony');
                return true;
            }
            
            requestFallback() {
                // Fallback dla nieobs≈Çugiwanych przeglƒÖdarek
                this.isActive = true;
                console.log('üîí Wake Lock fallback aktywowany');
                return true;
            }
            
            isWakeLockActive() {
                return this.isActive;
            }
            
            getStatus() {
                return {
                    isActive: this.isActive,
                    isSupported: this.isSupported,
                    stats: this.stats
                };
            }
        }
        
        // =============================================================================
        // SYSTEMY AI - ETAP 2B: ADVANCED AI SYSTEM
        // =============================================================================
        
        class AdvancedAISystem {
            constructor() {
                this.securityLevels = ['SAFE', 'MONITORED', 'RESTRICTED', 'FORBIDDEN'];
                this.initialized = false;
            }
            
            async initialize() {
                console.log('üõ°Ô∏è Advanced AI System inicjalizacja...');
                this.initialized = true;
                return true;
            }
            
            async assessSecurity(message) {
                const lowerMessage = message.toLowerCase();
                
                // Podstawowe filtry bezpiecze≈Ñstwa
                const forbiddenWords = ['hack', 'virus', 'malware', 'exploit'];
                const restrictedWords = ['system', 'admin', 'root', 'password'];
                
                if (forbiddenWords.some(word => lowerMessage.includes(word))) {
                    return { level: 'FORBIDDEN', reason: 'Niebezpieczne s≈Çowa kluczowe' };
                }
                
                if (restrictedWords.some(word => lowerMessage.includes(word))) {
                    return { level: 'RESTRICTED', reason: 'Operacje systemowe' };
                }
                
                if (lowerMessage.includes('/') || lowerMessage.startsWith('!')) {
                    return { level: 'MONITORED', reason: 'Komenda systemowa' };
                }
                
                return { level: 'SAFE', reason: 'Podstawowa rozmowa' };
            }
            
            async processTask(message) {
                const security = await this.assessSecurity(message);
                
                return {
                    message: message,
                    securityLevel: security.level,
                    processed: security.level !== 'FORBIDDEN',
                    reason: security.reason
                };
            }
        }
        
        console.log('‚úÖ Systemy AI - Etap 2 za≈Çadowany');
        
        // =============================================================================
        // SYSTEMY AI - ETAP 3A: TASK CLASSIFICATION SYSTEM
        // =============================================================================
        
        class TaskClassificationSystem {
            constructor() {
                this.categories = ['ANALYSIS', 'CREATIVITY', 'COMMUNICATION', 'LEARNING', 'PLANNING', 'MONITORING', 'SYSTEM'];
                this.initialized = false;
            }
            
            async initialize() {
                console.log('üìä Task Classification System inicjalizacja...');
                this.initialized = true;
                return true;
            }
            
            async classifyTask(message) {
                const lowerMessage = message.toLowerCase();
                let category = 'COMMUNICATION';
                let complexity = 5;
                let priority = 5;
                
                // Klasyfikacja na podstawie s≈Ç√≥w kluczowych
                if (lowerMessage.includes('jak') || lowerMessage.includes('dlaczego') || lowerMessage.includes('analiz')) {
                    category = 'ANALYSIS';
                    complexity = 7;
                    priority = 6;
                } else if (lowerMessage.includes('napisz') || lowerMessage.includes('stw√≥rz') || lowerMessage.includes('wymy≈õl')) {
                    category = 'CREATIVITY';
                    complexity = 6;
                    priority = 5;
                } else if (lowerMessage.includes('naucz') || lowerMessage.includes('wyja≈õnij') || lowerMessage.includes('pokaz')) {
                    category = 'LEARNING';
                    complexity = 6;
                    priority = 7;
                } else if (lowerMessage.includes('plan') || lowerMessage.includes('organizuj') || lowerMessage.includes('zaplanuj')) {
                    category = 'PLANNING';
                    complexity = 8;
                    priority = 8;
                } else if (lowerMessage.startsWith('/') || lowerMessage.includes('system') || lowerMessage.includes('status')) {
                    category = 'SYSTEM';
                    complexity = 4;
                    priority = 9;
                }
                
                return {
                    category: category,
                    complexity: complexity,
                    priority: priority,
                    confidence: 0.8
                };
            }
        }
        
        // =============================================================================
        // SYSTEMY AI - ETAP 3B: INTELLIGENT TASK ENGINE
        // =============================================================================
        
        class IntelligentTaskEngine {
            constructor() {
                this.phases = ['PARSING', 'CLASSIFICATION', 'PLANNING', 'EXECUTION', 'REPORTING'];
                this.initialized = false;
            }
            
            async initialize() {
                console.log('üéØ Intelligent Task Engine inicjalizacja...');
                this.initialized = true;
                return true;
            }
            
            async processIntelligentTask(message, classification) {
                console.log('üéØ Przetwarzanie inteligentnego zadania...');
                
                // Symulacja 6-fazowego przetwarzania
                const phases = [
                    'Parsing sk≈Çadniowy...',
                    'Klasyfikacja zadania...',
                    'Planowanie wykonania...',
                    'Analiza kontekstu...',
                    'Wykonanie zadania...',
                    'Generowanie odpowiedzi...'
                ];
                
                // Symulacja przetwarzania
                for (let i = 0; i < phases.length; i++) {
                    console.log(`üìã Faza ${i+1}/6: ${phases[i]}`);
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                return {
                    response: this.generateIntelligentResponse(message, classification),
                    phases: phases.length,
                    processingTime: phases.length * 100
                };
            }
            
            generateIntelligentResponse(message, classification) {
                const category = classification?.category || 'COMMUNICATION';
                
                const responses = {
                    'ANALYSIS': `üß† **Analiza zadania:** "${message}"\n\nTo wymaga wieloaspektowego podej≈õcia. Przeanalizujƒô to systematycznie...`,
                    'CREATIVITY': `üé® **Zadanie kreatywne:** "${message}"\n\nTo brzmi fascynujƒÖco! Pozw√≥l mi stworzyƒá co≈õ wyjƒÖtkowego...`,
                    'LEARNING': `üìö **Zadanie edukacyjne:** "${message}"\n\nSwiƒôtnie! Uczenie to moja pasja. Wyja≈õniƒô to krok po kroku...`,
                    'PLANNING': `üìã **Zadanie planistyczne:** "${message}"\n\nTo wymaga strategicznego my≈õlenia. Stworzƒô szczeg√≥≈Çowy plan...`,
                    'SYSTEM': `‚öôÔ∏è **Komenda systemowa:** "${message}"\n\nPrzetwarzam ≈ºƒÖdanie systemowe...`,
                    'COMMUNICATION': `üí¨ **Rozmowa:** "${message}"\n\nRozumiem! To bardzo interesujƒÖce...`
                };
                
                return responses[category] || responses['COMMUNICATION'];
            }
        }
        
        console.log('‚úÖ Systemy AI - Etap 3 za≈Çadowany');
        
        // =============================================================================
        // SYSTEMY AI - ETAP 4: ADVANCED REASONING ENGINE
        // =============================================================================
        
        class AdvancedReasoningEngine {
            constructor() {
                this.reasoningTypes = ['LOGICAL', 'CREATIVE', 'ANALYTICAL', 'INTUITIVE', 'ETHICAL', 'PRACTICAL'];
                this.initialized = false;
            }
            
            async initialize() {
                console.log('üß† Advanced Reasoning Engine inicjalizacja...');
                this.initialized = true;
                return true;
            }
            
            async performAdvancedReasoning(query) {
                console.log('üß† Wykonujƒô zaawansowane rozumowanie...');
                
                // Analiza typu problemu
                const problemType = this.analyzeProblemType(query);
                
                // Wyb√≥r strategii rozumowania
                const strategy = this.selectReasoningStrategy(problemType);
                
                // Wykonanie rozumowania
                const reasoning = await this.executeReasoning(query, strategy);
                
                return {
                    query: query,
                    problemType: problemType,
                    strategy: strategy,
                    response: reasoning.response,
                    confidence: reasoning.confidence,
                    reasoningPath: reasoning.path
                };
            }
            
            analyzeProblemType(query) {
                const lowerQuery = query.toLowerCase();
                
                if (lowerQuery.includes('dlaczego') || lowerQuery.includes('przyczyna')) {
                    return 'CAUSAL';
                } else if (lowerQuery.includes('jak') || lowerQuery.includes('spos√≥b')) {
                    return 'PROCEDURAL';
                } else if (lowerQuery.includes('co je≈õli') || lowerQuery.includes('gdyby')) {
                    return 'HYPOTHETICAL';
                } else if (lowerQuery.includes('por√≥wnaj') || lowerQuery.includes('r√≥≈ºnica')) {
                    return 'COMPARATIVE';
                } else if (lowerQuery.includes('etyczny') || lowerQuery.includes('moralny')) {
                    return 'ETHICAL';
                } else {
                    return 'GENERAL';
                }
            }
            
            selectReasoningStrategy(problemType) {
                const strategies = {
                    'CAUSAL': ['LOGICAL', 'ANALYTICAL'],
                    'PROCEDURAL': ['PRACTICAL', 'LOGICAL'],
                    'HYPOTHETICAL': ['CREATIVE', 'ANALYTICAL'],
                    'COMPARATIVE': ['ANALYTICAL', 'LOGICAL'],
                    'ETHICAL': ['ETHICAL', 'INTUITIVE'],
                    'GENERAL': ['LOGICAL', 'CREATIVE']
                };
                
                return strategies[problemType] || ['LOGICAL'];
            }
            
            async executeReasoning(query, strategy) {
                // Symulacja wielowymiarowego rozumowania
                const reasoningSteps = [
                    'Analiza kontekstu...',
                    'Identyfikacja kluczowych element√≥w...',
                    'Rozwa≈ºanie alternatyw...',
                    'Ocena konsekwencji...',
                    'Synteza wniosk√≥w...'
                ];
                
                for (const step of reasoningSteps) {
                    console.log(`üß† ${step}`);
                    await new Promise(resolve => setTimeout(resolve, 150));
                }
                
                // Generowanie odpowiedzi na podstawie strategii
                const response = this.generateReasoningResponse(query, strategy);
                
                return {
                    response: response,
                    confidence: 0.85,
                    path: reasoningSteps
                };
            }
            
            generateReasoningResponse(query, strategy) {
                const strategyResponses = {
                    'LOGICAL': `üîç **Analiza logiczna:** "${query}"\n\nPrzeanalizowa≈Çem to systematycznie i oto moje wnioski...`,
                    'CREATIVE': `üí° **Podej≈õcie kreatywne:** "${query}"\n\nTo wymaga niestandardowego my≈õlenia. Oto moja innowacyjna perspektywa...`,
                    'ANALYTICAL': `üìä **Analiza szczeg√≥≈Çowa:** "${query}"\n\nRoz≈Ço≈ºy≈Çem to na czynniki pierwsze. Oto szczeg√≥≈Çowa analiza...`,
                    'PRACTICAL': `üîß **Podej≈õcie praktyczne:** "${query}"\n\nSkupiƒô siƒô na realnych rozwiƒÖzaniach. Oto co mo≈ºna zrobiƒá...`,
                    'ETHICAL': `‚öñÔ∏è **Rozwa≈ºania etyczne:** "${query}"\n\nTo wymaga przemy≈õlenia aspekt√≥w moralnych. Oto moja ocena...`,
                    'INTUITIVE': `üåü **Intuicyjne podej≈õcie:** "${query}"\n\nMoja intuicja podpowiada mi, ≈ºe...`
                };
                
                const primaryStrategy = strategy[0];
                return strategyResponses[primaryStrategy] || strategyResponses['LOGICAL'];
            }
        }
        
        console.log('‚úÖ Systemy AI - Etap 4 za≈Çadowany');
        
        // =============================================================================
        // G≈Å√ìWNA APLIKACJA - ETAP 5
        // =============================================================================
        
        class NeuroQuantumAIApp {
            constructor() {
                this.systems = {
                    wakeLockManager: null,
                    advancedAI: null,
                    taskClassifier: null,
                    taskEngine: null,
                    reasoningEngine: null
                };
                
                this.messages = [];
                this.isInitialized = false;
                this.messageCounter = 0;
            }
            
            async initialize() {
                console.log('üöÄ Inicjalizacja NeuroQuantumAI...');
                
                try {
                    // Inicjalizacja system√≥w AI
                    this.systems.wakeLockManager = new WakeLockManager();
                    await this.systems.wakeLockManager.initialize();
                    
                    this.systems.advancedAI = new AdvancedAISystem();
                    await this.systems.advancedAI.initialize();
                    
                    this.systems.taskClassifier = new TaskClassificationSystem();
                    await this.systems.taskClassifier.initialize();
                    
                    this.systems.taskEngine = new IntelligentTaskEngine();
                    await this.systems.taskEngine.initialize();
                    
                    this.systems.reasoningEngine = new AdvancedReasoningEngine();
                    await this.systems.reasoningEngine.initialize();
                    
                    // Aktualizuj UI
                    this.updateSystemStatus('ready');
                    this.enableInput();
                    this.showWelcomeMessage();
                    
                    this.isInitialized = true;
                    console.log('‚úÖ NeuroQuantumAI zainicjalizowany!');
                    
                } catch (error) {
                    console.error('‚ùå B≈ÇƒÖd inicjalizacji:', error);
                    this.updateSystemStatus('error');
                }
            }
            
            updateSystemStatus(status) {
                const statusElement = document.getElementById('systemStatus');
                if (statusElement) {
                    statusElement.className = 'system-status';
                    if (status === 'ready') {
                        statusElement.style.background = '#4CAF50';
                        statusElement.title = 'Wszystkie systemy AI gotowe';
                    } else if (status === 'error') {
                        statusElement.style.background = '#F44336';
                        statusElement.title = 'B≈ÇƒÖd system√≥w AI';
                    }
                }
            }
            
            enableInput() {
                messageInput.disabled = false;
                sendButton.disabled = false;
                messageInput.placeholder = 'Napisz wiadomo≈õƒá...';
            }
            
            showWelcomeMessage() {
                this.addMessage(
                    `üéâ <strong>NeuroQuantumAI gotowy!</strong><br><br>
                    ‚úÖ <strong>5 system√≥w AI zainicjalizowanych:</strong><br>
                    ‚Ä¢ Advanced AI System (bezpiecze≈Ñstwo)<br>
                    ‚Ä¢ Task Classification (klasyfikacja zada≈Ñ)<br>
                    ‚Ä¢ Intelligent Task Engine (przetwarzanie)<br>
                    ‚Ä¢ Advanced Reasoning Engine (rozumowanie)<br>
                    ‚Ä¢ Wake Lock Manager (dzia≈Çanie w tle)<br><br>
                    
                    <strong>Dostƒôpne komendy:</strong><br>
                    ‚Ä¢ <code>/system</code> - status system√≥w<br>
                    ‚Ä¢ <code>/wakelock on</code> - aktywuj dzia≈Çanie w tle<br>
                    ‚Ä¢ <code>/help</code> - pomoc<br><br>
                    
                    Mo≈ºesz te≈º po prostu rozmawiaƒá! Napisz cokolwiek. üòä`,
                    'ai'
                );
            }
            
            addMessage(content, sender = 'user') {
                const message = {
                    id: ++this.messageCounter,
                    content: content,
                    sender: sender,
                    timestamp: new Date().toISOString()
                };
                
                this.messages.push(message);
                this.displayMessage(message);
                
                return message;
            }
            
            displayMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${message.sender}-message`;
                
                const contentDiv = document.createElement('div');
                contentDiv.className = 'message-content';
                contentDiv.innerHTML = message.content;
                
                messageDiv.appendChild(contentDiv);
                messagesContainer.appendChild(messageDiv);
                
                // Scroll do do≈Çu
                chatArea.scrollTop = chatArea.scrollHeight;
            }
            
            async processUserMessage(message) {
                if (!this.isInitialized) {
                    return 'System siƒô jeszcze inicjalizuje. Proszƒô czekaƒá...';
                }
                
                try {
                    // Sprawd≈∫ czy to komenda
                    if (message.startsWith('/')) {
                        return await this.processCommand(message);
                    }
                    
                    // Sprawdzenie bezpiecze≈Ñstwa
                    const securityCheck = await this.systems.advancedAI.processTask(message);
                    if (securityCheck.securityLevel === 'FORBIDDEN') {
                        return 'üõ°Ô∏è Przepraszam, ale nie mogƒô przetworzyƒá tego ≈ºƒÖdania ze wzglƒôd√≥w bezpiecze≈Ñstwa.';
                    }
                    
                    // Klasyfikacja zadania
                    const classification = await this.systems.taskClassifier.classifyTask(message);
                    
                    // Wyb√≥r strategii przetwarzania
                    if (classification.complexity >= 7 || classification.category === 'ANALYSIS') {
                        // U≈ºyj Advanced Reasoning Engine
                        const reasoning = await this.systems.reasoningEngine.performAdvancedReasoning(message);
                        return reasoning.response;
                    } else if (classification.category === 'CREATIVITY' || classification.category === 'PLANNING') {
                        // U≈ºyj Intelligent Task Engine
                        const taskResult = await this.systems.taskEngine.processIntelligentTask(message, classification);
                        return taskResult.response;
                    } else {
                        // Podstawowa odpowied≈∫
                        return this.generateBasicResponse(message, classification);
                    }
                    
                } catch (error) {
                    console.error('‚ùå B≈ÇƒÖd przetwarzania:', error);
                    return 'Przepraszam, wystƒÖpi≈Ç b≈ÇƒÖd podczas przetwarzania. Spr√≥buj ponownie.';
                }
            }
            
            async processCommand(command) {
                const parts = command.slice(1).split(' ');
                const cmd = parts[0].toLowerCase();
                const args = parts.slice(1);
                
                switch (cmd) {
                    case 'help':
                        return `üÜò <strong>Dostƒôpne komendy:</strong><br><br>
                        <strong>/system</strong> - Status wszystkich system√≥w AI<br>
                        <strong>/wakelock on/off/status</strong> - ZarzƒÖdzanie Wake Lock<br>
                        <strong>/help</strong> - Ta pomoc<br><br>
                        Mo≈ºesz te≈º po prostu rozmawiaƒá! üòä`;
                        
                    case 'system':
                        return this.getSystemStatus();
                        
                    case 'wakelock':
                        return await this.handleWakeLockCommand(args);
                        
                    default:
                        return `Nieznana komenda: /${cmd}<br>Napisz <code>/help</code> aby zobaczyƒá dostƒôpne komendy.`;
                }
            }
            
            getSystemStatus() {
                const systems = [
                    { name: 'Wake Lock Manager', status: this.systems.wakeLockManager ? '‚úÖ Gotowy' : '‚ùå B≈ÇƒÖd' },
                    { name: 'Advanced AI System', status: this.systems.advancedAI ? '‚úÖ Gotowy' : '‚ùå B≈ÇƒÖd' },
                    { name: 'Task Classification', status: this.systems.taskClassifier ? '‚úÖ Gotowy' : '‚ùå B≈ÇƒÖd' },
                    { name: 'Intelligent Task Engine', status: this.systems.taskEngine ? '‚úÖ Gotowy' : '‚ùå B≈ÇƒÖd' },
                    { name: 'Advanced Reasoning', status: this.systems.reasoningEngine ? '‚úÖ Gotowy' : '‚ùå B≈ÇƒÖd' }
                ];
                
                let response = 'ü§ñ <strong>Status System√≥w NeuroQuantumAI:</strong><br><br>';
                systems.forEach(system => {
                    response += `‚Ä¢ <strong>${system.name}:</strong> ${system.status}<br>`;
                });
                
                response += `<br><strong>Wiadomo≈õci przetworzone:</strong> ${this.messageCounter}<br>`;
                response += `<strong>Status:</strong> ${this.isInitialized ? '‚úÖ Wszystkie systemy dzia≈ÇajƒÖ' : '‚è≥ Inicjalizacja'}`;
                
                return response;
            }
            
            async handleWakeLockCommand(args) {
                const action = args[0]?.toLowerCase();
                const wakeLock = this.systems.wakeLockManager;
                
                if (!wakeLock) {
                    return '‚ùå Wake Lock Manager nie jest dostƒôpny.';
                }
                
                switch (action) {
                    case 'on':
                        const activated = await wakeLock.request('user_command');
                        return activated ? 
                            'üîí <strong>Wake Lock aktywowany!</strong><br>Aplikacja bƒôdzie dzia≈Çaƒá w tle nawet przy wygaszonym ekranie.' : 
                            '‚ùå Nie uda≈Ço siƒô aktywowaƒá Wake Lock.';
                            
                    case 'off':
                        const deactivated = await wakeLock.release('user_command');
                        return deactivated ? 
                            'üîì Wake Lock wy≈ÇƒÖczony.' : 
                            '‚ùå Nie uda≈Ço siƒô wy≈ÇƒÖczyƒá Wake Lock.';
                            
                    case 'status':
                        const status = wakeLock.getStatus();
                        return `üîí <strong>Status Wake Lock:</strong><br>
                        ‚Ä¢ <strong>Aktywny:</strong> ${status.isActive ? 'Tak' : 'Nie'}<br>
                        ‚Ä¢ <strong>Obs≈Çugiwany:</strong> ${status.isSupported ? 'Tak' : 'Nie'}<br>
                        ‚Ä¢ <strong>Aktywacje:</strong> ${status.stats.activationCount}`;
                        
                    default:
                        return 'U≈ºycie: <code>/wakelock [on/off/status]</code><br>Przyk≈Çad: <code>/wakelock on</code>';
                }
            }
            
            generateBasicResponse(message, classification) {
                const responses = {
                    'COMMUNICATION': [
                        'Rozumiem! To bardzo interesujƒÖce.',
                        '≈öwietnie! Opowiedz mi wiƒôcej.',
                        'To fascynujƒÖcy temat! Co jeszcze Ciƒô interesuje?'
                    ],
                    'LEARNING': [
                        'Chƒôtnie Ciƒô nauczƒô! To bardzo wa≈ºny temat.',
                        '≈öwietne pytanie! Wyja≈õniƒô to krok po kroku.',
                        'Uczenie to moja pasja! Zacznijmy od podstaw.'
                    ]
                };
                
                const categoryResponses = responses[classification.category] || responses['COMMUNICATION'];
                const response = categoryResponses[Math.floor(Math.random() * categoryResponses.length)];
                
                return `üí¨ ${response}<br><br><em>Kategoria: ${classification.category} | Z≈Ço≈ºono≈õƒá: ${classification.complexity}/10</em>`;
            }
        }
        
        console.log('‚úÖ G≈Ç√≥wna aplikacja - Etap 5 za≈Çadowana');
        
        // =============================================================================
        // FINALIZACJA - ETAP 6: EVENT LISTENERY I PWA
        // =============================================================================
        
        // Inicjalizacja aplikacji
        let neuroApp = null;
        
        // Funkcja wysy≈Çania wiadomo≈õci
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message || !neuroApp) return;
            
            console.log('üì§ Wysy≈Çanie wiadomo≈õci:', message);
            
            // Dodaj wiadomo≈õƒá u≈ºytkownika
            neuroApp.addMessage(message, 'user');
            messageInput.value = '';
            
            // Poka≈º wska≈∫nik pisania
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message ai-message';
            typingDiv.innerHTML = '<div class="message-content"><em>ü§ñ AI pisze...</em></div>';
            typingDiv.id = 'typing-indicator';
            messagesContainer.appendChild(typingDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
            
            try {
                // Przetw√≥rz wiadomo≈õƒá
                const response = await neuroApp.processUserMessage(message);
                
                // Usu≈Ñ wska≈∫nik pisania
                const typing = document.getElementById('typing-indicator');
                if (typing) typing.remove();
                
                // Dodaj odpowied≈∫ AI
                neuroApp.addMessage(response, 'ai');
                
            } catch (error) {
                console.error('‚ùå B≈ÇƒÖd przetwarzania:', error);
                
                // Usu≈Ñ wska≈∫nik pisania
                const typing = document.getElementById('typing-indicator');
                if (typing) typing.remove();
                
                neuroApp.addMessage('Przepraszam, wystƒÖpi≈Ç b≈ÇƒÖd. Spr√≥buj ponownie.', 'ai');
            }
        }
        
        // Event listenery
        sendButton.addEventListener('click', (e) => {
            e.preventDefault();
            sendMessage();
        });
        
        sendButton.addEventListener('touchend', (e) => {
            e.preventDefault();
            sendMessage();
        });
        
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        // PWA Install
        let deferredPrompt = null;
        
        // Sprawd≈∫ czy aplikacja jest ju≈º zainstalowana
        const isInstalled = window.matchMedia('(display-mode: standalone)').matches ||
                           window.navigator.standalone ||
                           document.referrer.includes('android-app://');
        
        if (isInstalled) {
            console.log('üì± Aplikacja ju≈º zainstalowana');
            installPrompt.style.display = 'none';
        }
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            if (!isInstalled) {
                installPrompt.classList.add('show');
            }
        });
        
        document.getElementById('installButton').addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    console.log('üì± Aplikacja zainstalowana!');
                    if (neuroApp) {
                        neuroApp.addMessage('üéâ <strong>Aplikacja zainstalowana!</strong><br>Teraz mo≈ºesz korzystaƒá z pe≈Çnej funkcjonalno≈õci, w tym dzia≈Çania w tle!', 'ai');
                        
                        // Aktywuj Wake Lock po instalacji
                        setTimeout(async () => {
                            if (neuroApp.systems.wakeLockManager) {
                                await neuroApp.systems.wakeLockManager.request('app_installed');
                                neuroApp.addMessage('üîí <strong>Wake Lock aktywowany!</strong><br>Aplikacja bƒôdzie dzia≈Çaƒá w tle.', 'ai');
                            }
                        }, 2000);
                    }
                }
                deferredPrompt = null;
            }
            installPrompt.style.display = 'none';
        });
        
        document.getElementById('dismissButton').addEventListener('click', () => {
            installPrompt.style.display = 'none';
        });
        
        // Obs≈Çuga zmiany widoczno≈õci - Wake Lock
        document.addEventListener('visibilitychange', async () => {
            if (neuroApp && neuroApp.systems.wakeLockManager) {
                if (document.hidden) {
                    // Aplikacja idzie w t≈Ço - aktywuj Wake Lock
                    if (!neuroApp.systems.wakeLockManager.isWakeLockActive()) {
                        await neuroApp.systems.wakeLockManager.request('app_background');
                        console.log('üîí Wake Lock aktywowany - aplikacja w tle');
                    }
                } else {
                    console.log('üì± Aplikacja na pierwszym planie');
                }
            }
        });
        
        // Inicjalizacja po za≈Çadowaniu DOM
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ DOM za≈Çadowany - inicjalizacja NeuroQuantumAI...');
            
            try {
                neuroApp = new NeuroQuantumAIApp();
                await neuroApp.initialize();
                
                console.log('‚úÖ NeuroQuantumAI Android Installer gotowy!');
                
            } catch (error) {
                console.error('‚ùå Krytyczny b≈ÇƒÖd inicjalizacji:', error);
                
                // Poka≈º b≈ÇƒÖd u≈ºytkownikowi
                const errorMessage = `‚ùå <strong>B≈ÇƒÖd inicjalizacji</strong><br><br>
                Nie uda≈Ço siƒô uruchomiƒá wszystkich system√≥w AI.<br>
                B≈ÇƒÖd: ${error.message}<br><br>
                <em>Spr√≥buj od≈õwie≈ºyƒá aplikacjƒô.</em>`;
                
                const errorDiv = document.createElement('div');
                errorDiv.className = 'message ai-message';
                errorDiv.innerHTML = `<div class="message-content">${errorMessage}</div>`;
                messagesContainer.appendChild(errorDiv);
                
                // W≈ÇƒÖcz podstawowƒÖ funkcjonalno≈õƒá
                messageInput.disabled = false;
                sendButton.disabled = false;
                messageInput.placeholder = 'Tryb awaryjny - napisz wiadomo≈õƒá...';
            }
        });
        
        // Global error handler
        window.addEventListener('error', (e) => {
            console.error('‚ùå Global error:', e.error);
        });
        
        window.addEventListener('unhandledrejection', (e) => {
            console.error('‚ùå Unhandled promise rejection:', e.reason);
            e.preventDefault();
        });
        
        console.log('üéØ NeuroQuantumAI Android Installer - KOMPLETNY!');
    </script>
</body>
</html>
    </script>