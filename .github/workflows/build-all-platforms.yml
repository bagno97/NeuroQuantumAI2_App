name: Build NeuroQuantumAI - All Platforms

on:
  push:
    branches: [ main, master ]
    tags: [ 'v*' ]
  workflow_dispatch:
    inputs:
      build_type:
        description: 'Build type'
        required: true
        default: 'release'
        type: choice
        options:
        - release
        - debug

jobs:
  build-android-apk:
    name: Build Android APK
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Build NeuroQuantumAI APK
      run: |
        echo "ðŸ§  Building NeuroQuantumAI APK..."
        echo "ðŸ“± Target: Samsung Galaxy A35 5G"
        echo "ðŸ¤– AI Systems: 9 modules"
        
        python create_valid_apk.py
        
        # Verify APK was created
        if [ -f "NeuroQuantumAI-Valid-v1.0.0.apk" ]; then
          echo "âœ… APK created successfully"
          ls -la NeuroQuantumAI-Valid-v1.0.0.apk
        else
          echo "âŒ APK creation failed"
          exit 1
        fi
    
    - name: Upload APK Artifact
      uses: actions/upload-artifact@v4
      with:
        name: NeuroQuantumAI-Android-APK
        path: NeuroQuantumAI-Valid-v1.0.0.apk
        retention-days: 90

  build-windows-app:
    name: Build Windows Application
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
    
    - name: Build Windows App
      run: |
        echo "ðŸ’» Building NeuroQuantumAI for Windows..."
        cd NeuroQuantumAI-Windows
        npm install
        npm run build-win
    
    - name: Upload Windows App
      uses: actions/upload-artifact@v4
      with:
        name: NeuroQuantumAI-Windows-App
        path: NeuroQuantumAI-Windows/dist/*.exe
        retention-days: 90

  build-web-app:
    name: Build Web Application
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Create Web Package
      run: |
        echo "ðŸŒ Building NeuroQuantumAI Web App..."
        
        # Create web package
        mkdir -p web-app
        cp NeuroQuantumAI_Android_Installer.html web-app/index.html
        cp quantum_neural_foundation.js web-app/
        cp neurogenesis_system.js web-app/
        cp self_modification_simulator.js web-app/
        cp advanced_ai_system.js web-app/
        cp task_classification_system.js web-app/
        cp intelligent_task_engine.js web-app/
        cp advanced_reasoning_engine.js web-app/
        cp persistent_neural_storage.js web-app/
        cp wake_lock_manager.js web-app/
        cp manifest.json web-app/
        cp sw.js web-app/
        cp icon-*.png web-app/
        
        # Create package
        zip -r NeuroQuantumAI-Web-App.zip web-app/
        
        echo "âœ… Web app package created"
        ls -la NeuroQuantumAI-Web-App.zip
    
    - name: Upload Web App
      uses: actions/upload-artifact@v4
      with:
        name: NeuroQuantumAI-Web-App
        path: NeuroQuantumAI-Web-App.zip
        retention-days: 90

  create-github-release:
    name: Create GitHub Release
    needs: [build-android-apk, build-windows-app, build-web-app]
    runs-on: ubuntu-latest
    if: startsWith(github.ref, 'refs/tags/v') || github.ref == 'refs/heads/main'
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Download all artifacts
      uses: actions/download-artifact@v4
      with:
        path: ./release-assets/
    
    - name: Prepare release assets
      run: |
        echo "ðŸ“¦ Preparing release assets..."
        ls -la release-assets/
        
        # Move files to root level
        find release-assets/ -type f -name "*.apk" -exec cp {} ./ \;
        find release-assets/ -type f -name "*.exe" -exec cp {} ./ \;
        find release-assets/ -type f -name "*.zip" -exec cp {} ./ \;
        
        echo "âœ… Release assets prepared:"
        ls -la *.apk *.exe *.zip 2>/dev/null || echo "Some file types not found"
    
    - name: Generate release notes
      run: |
        cat > RELEASE_NOTES.md << 'EOF'
        # ðŸ§  NeuroQuantumAI - Quantum Neural Networks
        
        ## ðŸš€ **Najnowsza wersja z wszystkimi systemami AI!**
        
        ### **ðŸ“± Android APK (Samsung Galaxy A35 5G)**
        - `NeuroQuantumAI-Valid-v1.0.0.apk` - GÅ‚Ã³wna aplikacja Android
        - Rozmiar: ~22KB
        - Wszystkie 9 systemÃ³w AI wbudowane
        
        ### **ðŸ’» Windows Application**
        - `NeuroQuantumAI-Setup.exe` - Installer dla Windows 10/11
        - Natywna aplikacja Electron
        - PeÅ‚na funkcjonalnoÅ›Ä‡ desktop
        
        ### **ðŸŒ Web Application**
        - `NeuroQuantumAI-Web-App.zip` - PWA do hostowania
        - DziaÅ‚a w kaÅ¼dej przeglÄ…darce
        - Instalowalna jako PWA
        
        ## ðŸ§  **Zawarte systemy AI:**
        
        âœ… **Quantum Neural Foundation** - neurony kwantowe z superpozycjÄ… stanÃ³w
        âœ… **Neurogenesis System** - tworzenie nowych neuronÃ³w (max 1000)
        âœ… **Self-Modification Simulator** - bezpieczna samomodyfikacja w wirtualnym Å›rodowisku
        âœ… **Advanced Reasoning Engine** - 6-wymiarowe rozumowanie (logiczne, emocjonalne, kreatywne, praktyczne, etyczne, strategiczne)
        âœ… **Task Classification System** - klasyfikacja zadaÅ„ w 7 kategoriach z poziomami zÅ‚oÅ¼onoÅ›ci 1-10
        âœ… **Intelligent Task Engine** - 6-fazowe przetwarzanie zÅ‚oÅ¼onych zadaÅ„ z kontekst awareness
        âœ… **Persistent Neural Storage** - szyfrowane przechowywanie danych z kompresjÄ… i automatycznym backup
        âœ… **Advanced AI System** - 4 poziomy bezpieczeÅ„stwa (SAFE, MONITORED, RESTRICTED, FORBIDDEN)
        âœ… **Wake Lock Manager** - dziaÅ‚anie w tle z automatycznym zarzÄ…dzaniem zasobami
        
        ## ðŸ“‹ **Instalacja:**
        
        ### **Android (Samsung Galaxy A35 5G):**
        1. Pobierz `NeuroQuantumAI-Valid-v1.0.0.apk`
        2. WÅ‚Ä…cz "Nieznane ÅºrÃ³dÅ‚a" w ustawieniach bezpieczeÅ„stwa
        3. Zainstaluj APK
        4. Uruchom NeuroQuantumAI z ekranu gÅ‚Ã³wnego
        
        ### **Windows 10/11:**
        1. Pobierz `NeuroQuantumAI-Setup.exe`
        2. Uruchom installer
        3. PostÄ™puj zgodnie z instrukcjami
        4. Uruchom z menu Start lub pulpitu
        
        ### **Web/PWA:**
        1. Pobierz `NeuroQuantumAI-Web-App.zip`
        2. Rozpakuj na serwerze web
        3. OtwÃ³rz `index.html` w przeglÄ…darce
        4. Zainstaluj jako PWA (opcjonalnie)
        
        ## ðŸŽ¯ **Funkcje:**
        
        - **Inteligentny chat** z zaawansowanymi systemami AI
        - **Quantum neural processing** z superpozycjÄ… stanÃ³w
        - **Neurogenesis** - tworzenie neuronÃ³w w czasie rzeczywistym
        - **Self-modification** - bezpieczne dostosowywanie algorytmÃ³w
        - **Multi-dimensional reasoning** - analiza z 6 perspektyw
        - **Task classification** - automatyczne rozpoznawanie typu zadania
        - **Persistent learning** - zapamiÄ™tywanie preferencji uÅ¼ytkownika
        - **Background processing** - dziaÅ‚anie w tle
        - **Encrypted storage** - bezpieczne przechowywanie danych
        
        ## ðŸ”§ **Wymagania systemowe:**
        
        ### **Android:**
        - Android 7.0+ (API 24+)
        - 50MB wolnego miejsca
        - PoÅ‚Ä…czenie internetowe (zalecane)
        
        ### **Windows:**
        - Windows 10 (1903+) lub Windows 11
        - 4GB RAM (zalecane 8GB)
        - 200MB wolnego miejsca
        - PoÅ‚Ä…czenie internetowe
        
        ### **Web:**
        - Nowoczesna przeglÄ…darka (Chrome 80+, Firefox 75+, Safari 13+)
        - JavaScript wÅ‚Ä…czony
        - 50MB pamiÄ™ci RAM
        
        ---
        
        **ðŸ¤– Automatycznie zbudowane przez GitHub Actions**
        **ðŸ“… Data: $(date)**
        **ðŸ”— Repozytorium: https://github.com/[USERNAME]/NeuroQuantumAI**
        EOF
    
    - name: Create Release
      uses: softprops/action-gh-release@v1
      with:
        tag_name: ${{ github.ref_name }}
        name: NeuroQuantumAI ${{ github.ref_name }}
        body_path: RELEASE_NOTES.md
        files: |
          *.apk
          *.exe
          *.zip
        draft: false
        prerelease: false
        generate_release_notes: true
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  deploy-web-demo:
    name: Deploy Web Demo
    needs: [build-web-app]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Pages
      uses: actions/configure-pages@v3
    
    - name: Download web app
      uses: actions/download-artifact@v4
      with:
        name: NeuroQuantumAI-Web-App
        path: ./
    
    - name: Extract web app
      run: |
        unzip NeuroQuantumAI-Web-App.zip
        mv web-app/* ./
        ls -la
    
    - name: Upload to Pages
      uses: actions/upload-pages-artifact@v2
      with:
        path: ./
    
    - name: Deploy to Pages
      uses: actions/deploy-pages@v2
      id: deployment